<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Blog Photo Shuffler Mobile V3.1</title>
    <!-- ëª¨ë°”ì¼ ì•±ì²˜ëŸ¼ ë³´ì´ê²Œ í•˜ëŠ” ë©”íƒ€íƒœê·¸ -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0a0a0a">
    
    <!-- JSZip -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { background: #0a0a0a; font-family: 'Pretendard', -apple-system, sans-serif; -webkit-tap-highlight-color: transparent; }
        /* í„°ì¹˜ ì˜ì—­ í™•ëŒ€ */
        .touch-target { min-height: 44px; }
        .category-box { border: 2px dashed #374151; transition: all 0.2s; }
        .category-box:active { border-color: #10b981; background: #064e3b20; }
        
        /* ë„¤ì˜¨ íš¨ê³¼ (ëª¨ë°”ì¼ ì„±ëŠ¥ ìœ„í•´ ê·¸ë¦¼ì ì¶•ì†Œ) */
        .neon-btn { box-shadow: 0 0 10px #10b98140; }
        .neon-btn:active { box-shadow: 0 0 20px #10b98160; transform: scale(0.98); }
        .neon-text { text-shadow: 0 0 8px #10b981; }

        /* ëª¨ë°”ì¼ ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¹€ (ê¹”ë”í•˜ê²Œ) */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }

        #loadingOverlay {
            backdrop-filter: blur(5px);
            background: rgba(0, 0, 0, 0.85);
        }
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #374151;
            border-top: 4px solid #10b981;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body class="text-gray-100 min-h-screen flex flex-col pb-safe">

<!-- ë¡œë”© í™”ë©´ -->
<div id="loadingOverlay" class="fixed inset-0 z-[100] hidden flex flex-col items-center justify-center px-6 text-center">
    <div class="spinner mb-6"></div>
    <h3 class="text-2xl font-bold text-white mb-2">ì‘ì—… ì¤‘...</h3>
    <p id="loadingText" class="text-emerald-400 text-lg font-bold">ì¤€ë¹„ ì¤‘</p>
    <p id="loadingSubText" class="text-gray-400 text-sm mt-4 leading-relaxed bg-gray-900/50 p-4 rounded-lg w-full">
        ìŠ¤ë§ˆíŠ¸í° ë©”ëª¨ë¦¬ ë³´í˜¸ë¥¼ ìœ„í•´<br>
        <span class="text-white font-bold">10ì„¸íŠ¸ì”©</span> ë‚˜ëˆ„ì–´ ì €ì¥ë©ë‹ˆë‹¤.<br>
        <span class="text-amber-400 text-xs">í™”ë©´ì„ ë„ì§€ ë§ˆì„¸ìš”!</span>
    </p>
</div>

<!-- ìƒë‹¨ í—¤ë” -->
<div class="p-4 border-b border-gray-800 bg-gray-900/80 backdrop-blur sticky top-0 z-10">
    <div class="flex justify-between items-center max-w-lg mx-auto">
        <div>
            <h1 class="text-xl font-bold neon-text">Photo Shuffler M</h1>
            <p class="text-xs text-gray-400">ëª¨ë°”ì¼ ìµœì í™” ë²„ì „ V3.1</p>
        </div>
        <button onclick="document.getElementById('settingsPanel').classList.toggle('hidden')" class="p-2 text-gray-400 hover:text-white">
            âš™ï¸ì„¤ì •
        </button>
    </div>
</div>

<div class="flex-1 p-4 max-w-lg mx-auto w-full">
    
    <!-- ì„¤ì • íŒ¨ë„ (í† ê¸€í˜•) -->
    <div id="settingsPanel" class="hidden mb-6 bg-gray-800 rounded-xl p-4 border border-gray-700 animate-fade-in">
        <h2 class="text-lg font-bold text-emerald-400 mb-4 flex justify-between items-center">
            ì„¤ì •
            <button onclick="saveSettings()" class="text-xs bg-emerald-900 text-emerald-200 px-2 py-1 rounded">ì €ì¥ë¨</button>
        </h2>
        
        <div class="space-y-4">
            <div>
                <label class="text-xs text-gray-400 block mb-1">ì—…ì²´ëª… (í´ë”ëª…)</label>
                <input type="text" id="companyName" placeholder="ì˜ˆ: ë§›ì§‘_ê°•ë‚¨ì " onchange="saveSettings()"
                    class="w-full bg-gray-900 border border-gray-600 rounded-lg px-3 py-3 text-white focus:border-emerald-500 outline-none">
            </div>

            <div>
                <label class="text-xs text-gray-400 block mb-1">í´ë” ê°œìˆ˜ (Max 500)</label>
                <div class="flex items-center gap-2">
                    <input type="number" id="folderCount" value="30" min="1" max="500" onchange="saveSettings(); updateSummary();"
                        class="flex-1 bg-gray-900 border border-gray-600 rounded-lg px-3 py-3 text-lg font-bold text-center text-white focus:border-emerald-500 outline-none">
                    <span class="text-gray-500 text-sm">ì„¸íŠ¸</span>
                </div>
            </div>

            <div class="flex items-center justify-between py-2 border-t border-gray-700">
                <label class="text-sm text-gray-300">ì´ë¯¸ì§€ ì¤‘ë³µ í—ˆìš©</label>
                <input type="checkbox" id="allowDuplicate" onchange="saveSettings(); updateSummary();" class="w-6 h-6 accent-emerald-500">
            </div>

            <div class="flex items-center justify-between py-2 border-t border-gray-700">
                <div class="flex flex-col">
                    <label class="text-sm font-bold text-orange-400">ê°œì¸ì •ë³´ ì œê±°</label>
                    <span class="text-[10px] text-gray-500">GPS/ì´¬ì˜ì •ë³´ ì‚­ì œ (ëŠë¦¼)</span>
                </div>
                <input type="checkbox" id="removeMetadata" onchange="saveSettings()" class="w-6 h-6 accent-orange-500">
            </div>
            
            <button onclick="resetCategories()" class="w-full py-3 mt-2 text-xs text-red-400 border border-red-900/50 rounded-lg bg-red-900/10">
                ëª¨ë“  ì„¤ì • ì´ˆê¸°í™”
            </button>
        </div>
    </div>

    <!-- ë©”ì¸ ì•¡ì…˜ ë²„íŠ¼ -->
    <div class="sticky bottom-4 z-20 mb-6">
        <button onclick="generateZip()" class="w-full py-4 bg-gradient-to-r from-emerald-600 to-teal-600 rounded-xl font-bold text-lg text-white shadow-lg neon-btn flex items-center justify-center gap-2">
            <span>ğŸ“¦</span> ZIP ìƒì„± & ë‹¤ìš´ë¡œë“œ
        </button>
        <div id="warningBox" class="hidden mt-2 p-3 bg-amber-900/80 border border-amber-700 rounded-lg text-amber-100 text-xs text-center shadow-lg backdrop-blur"></div>
    </div>

    <!-- ì¹´í…Œê³ ë¦¬ ëª©ë¡ -->
    <div class="flex justify-between items-center mb-3">
        <h2 class="text-lg font-bold text-gray-200">ì¹´í…Œê³ ë¦¬ <span id="catCountBadge" class="text-sm font-normal text-gray-500 ml-1">(0)</span></h2>
        <button onclick="addCategory()" class="bg-gray-800 hover:bg-gray-700 text-emerald-400 px-4 py-2 rounded-lg text-sm font-bold border border-gray-700">
            + ì¶”ê°€
        </button>
    </div>

    <div id="categories" class="space-y-4 pb-20">
        <!-- ì¹´í…Œê³ ë¦¬ ì•„ì´í…œì´ ì—¬ê¸°ì— ì¶”ê°€ë¨ -->
    </div>

</div>

<script>
let categories = [];
let nextId = 1;

// ëª¨ë°”ì¼ì€ ë©”ëª¨ë¦¬ê°€ ì ìœ¼ë¯€ë¡œ 10ê°œì”© ëŠì–´ì„œ ì²˜ë¦¬
const MOBILE_BATCH_SIZE = 10; 

function init() {
    loadSettings();
    if (categories.length === 0) {
        initDefaultCategories();
    }
    renderCategories();
}

function initDefaultCategories() {
  const defaults = ['ë©”ë‰´íŒ', 'ë©”ì¸ìŒì‹', 'ì‚¬ì´ë“œ', 'ë‚´ë¶€', 'ì™¸ë¶€'];
  defaults.forEach(name => addCategory(name, false)); 
  saveSettings();
}

function resetCategories() {
    if(confirm('ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        categories = [];
        nextId = 1;
        initDefaultCategories();
        renderCategories();
        document.getElementById('settingsPanel').classList.add('hidden');
    }
}

// --- ë°ì´í„° ê´€ë¦¬ ---

function addCategory(name = '', shouldRender = true) {
  const id = nextId++;
  const cat = {
    id,
    name: name || `ì¹´í…Œê³ ë¦¬${id}`,
    mode: 'required', 
    requiredCount: 1,
    probabilityN: 10,
    files: []
  };
  categories.push(cat);
  if (shouldRender) {
      saveSettings();
      renderCategories();
  }
}

function removeCategory(id) {
  if (confirm('ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
    categories = categories.filter(c => c.id !== id);
    saveSettings();
    renderCategories();
  }
}

function moveCategory(index, direction) {
    if (direction === -1 && index > 0) {
        [categories[index], categories[index - 1]] = [categories[index - 1], categories[index]];
    } else if (direction === 1 && index < categories.length - 1) {
        [categories[index], categories[index + 1]] = [categories[index + 1], categories[index]];
    }
    saveSettings();
    renderCategories();
}

function saveSettings() {
    const settings = {
        companyName: document.getElementById('companyName').value,
        folderCount: document.getElementById('folderCount').value,
        allowDuplicate: document.getElementById('allowDuplicate').checked,
        removeMetadata: document.getElementById('removeMetadata').checked,
        categories: categories.map(c => ({
            name: c.name,
            mode: c.mode,
            requiredCount: c.requiredCount,
            probabilityN: c.probabilityN
        }))
    };
    localStorage.setItem('blogShufflerMobileV3', JSON.stringify(settings));
}

function loadSettings() {
    const saved = localStorage.getItem('blogShufflerMobileV3');
    if (saved) {
        try {
            const parsed = JSON.parse(saved);
            document.getElementById('companyName').value = parsed.companyName || '';
            document.getElementById('folderCount').value = parsed.folderCount || 30;
            document.getElementById('allowDuplicate').checked = parsed.allowDuplicate || false;
            document.getElementById('removeMetadata').checked = parsed.removeMetadata || false;
            
            if (parsed.categories && Array.isArray(parsed.categories)) {
                categories = parsed.categories.map((c, idx) => ({
                    id: nextId++,
                    name: c.name,
                    mode: c.mode || 'required',
                    requiredCount: c.requiredCount || 1,
                    probabilityN: c.probabilityN || 10,
                    files: []
                }));
            }
        } catch (e) { console.error(e); }
    }
}

// --- ë Œë”ë§ (ëª¨ë°”ì¼ ìµœì í™” UI) ---

function renderCategories() {
  const container = document.getElementById('categories');
  document.getElementById('catCountBadge').textContent = `(${categories.length})`;
  
  if (categories.length === 0) {
      container.innerHTML = `<div class="text-center text-gray-600 py-10">ì¹´í…Œê³ ë¦¬ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</div>`;
      updateSummary();
      return;
  }

  container.innerHTML = categories.map((cat, idx) => `
    <div class="category-box bg-gray-800 rounded-xl p-4 relative" data-id="${cat.id}">
      
      <!-- í—¤ë”: ìˆœì„œ/ì´ë¦„/ì‚­ì œ -->
      <div class="flex items-center gap-2 mb-3">
        <div class="flex flex-col gap-1">
             <button onclick="moveCategory(${idx}, -1)" class="w-6 h-6 bg-gray-700 rounded text-gray-400 text-[10px] ${idx === 0 ? 'invisible' : ''}">â–²</button>
             <button onclick="moveCategory(${idx}, 1)" class="w-6 h-6 bg-gray-700 rounded text-gray-400 text-[10px] ${idx === categories.length - 1 ? 'invisible' : ''}">â–¼</button>
        </div>
        <div class="flex-1">
            <input type="text" value="${cat.name}" 
                onchange="updateCategoryName(${cat.id}, this.value)"
                class="w-full bg-transparent text-lg font-bold text-white border-b border-gray-600 focus:border-emerald-500 outline-none pb-1" placeholder="ì¹´í…Œê³ ë¦¬ëª…">
        </div>
        <button onclick="removeCategory(${cat.id})" class="w-8 h-8 flex items-center justify-center text-red-400 bg-red-900/20 rounded-full">âœ•</button>
      </div>

      <!-- ì˜µì…˜ (ê°„ì†Œí™”) -->
      <div class="bg-gray-900/50 rounded-lg p-2 mb-3 flex items-center justify-between text-sm">
         <select onchange="updateCategoryMode(${cat.id}, this.value)" 
             class="bg-transparent text-gray-300 text-xs outline-none w-1/2">
             <option value="required" ${cat.mode === 'required' ? 'selected' : ''}>í•„ìˆ˜ í¬í•¨ (ì¥)</option>
             <option value="probability" ${cat.mode === 'probability' ? 'selected' : ''}>í™•ë¥  í¬í•¨ (1/N)</option>
         </select>
         <div class="flex items-center gap-2 border-l border-gray-700 pl-3">
            <span class="text-xs text-gray-500">${cat.mode === 'required' ? 'ê°œìˆ˜' : 'ê°„ê²©'}</span>
            <input type="number" value="${cat.mode === 'required' ? cat.requiredCount : cat.probabilityN}" 
                onchange="updateCount(${cat.id}, this.value, '${cat.mode}')"
                class="w-12 bg-gray-700 rounded px-1 py-1 text-center text-white font-bold outline-none">
         </div>
      </div>

      <!-- íŒŒì¼ ì—…ë¡œë“œ (í„°ì¹˜ ì˜ì—­ í™•ëŒ€) -->
      <div class="relative bg-gray-900 border-2 border-dashed border-gray-700 rounded-xl h-24 flex flex-col items-center justify-center cursor-pointer active:border-emerald-500 active:bg-gray-800 transition"
           onclick="document.getElementById('file-${cat.id}').click()">
        <input type="file" id="file-${cat.id}" multiple accept="image/*" 
           onchange="handleFileSelect(event, ${cat.id})" class="hidden">
        
        ${cat.files.length > 0 
          ? `<div class="text-emerald-400 font-bold text-2xl">${cat.files.length}ì¥</div><div class="text-[10px] text-gray-500">í„°ì¹˜í•˜ì—¬ ì¶”ê°€</div>` 
          : `<div class="text-2xl mb-1">ğŸ“·</div><span class="text-xs text-gray-500">ì‚¬ì§„ ì„ íƒ</span>`}
      </div>
    </div>
  `).join('');
  
  updateSummary();
}

// --- ì—…ë°ì´íŠ¸ í•¨ìˆ˜ë“¤ ---

function updateCategoryName(id, val) { 
    categories.find(c => c.id === id).name = val; saveSettings(); 
}
function updateCategoryMode(id, val) { 
    categories.find(c => c.id === id).mode = val; saveSettings(); renderCategories(); 
}
function updateCount(id, val, mode) {
    const cat = categories.find(c => c.id === id);
    if(mode === 'required') cat.requiredCount = parseInt(val);
    else cat.probabilityN = parseInt(val);
    saveSettings(); updateSummary();
}

function handleFileSelect(e, catId) {
    const files = Array.from(e.target.files);
    const cat = categories.find(c => c.id === catId);
    cat.files.push(...files);
    renderCategories();
    e.target.value = '';
}

function updateSummary() {
    const folderCount = parseInt(document.getElementById('folderCount').value) || 0;
    let warnings = [];
    
    categories.forEach(cat => {
        if (cat.mode === 'required') {
            const needed = folderCount * cat.requiredCount;
            if (cat.files.length < needed) {
                warnings.push(`${cat.name}: ${needed - cat.files.length}ì¥ ë¶€ì¡±`);
            }
        }
    });

    const warningBox = document.getElementById('warningBox');
    if (warnings.length > 0) {
        warningBox.innerHTML = `âš ï¸ <b>ì´ë¯¸ì§€ ë¶€ì¡±</b><br>${warnings.join(', ')}`;
        warningBox.classList.remove('hidden');
    } else {
        warningBox.classList.add('hidden');
    }
}

// --- ë¡œì§ (ìœ í‹¸) ---

function shuffle(arr) {
    const result = [...arr];
    for (let i = result.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [result[i], result[j]] = [result[j], result[i]];
    }
    return result;
}

function downloadBlob(blob, filename) {
    try {
        const url = window.URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = filename;
        document.body.appendChild(a);
        a.click();
        setTimeout(() => {
            window.URL.revokeObjectURL(url);
            document.body.removeChild(a);
        }, 1000); 
    } catch (e) { console.error(e); }
}

async function cleanImage(file) {
    return new Promise((resolve) => {
        const img = new Image();
        const url = URL.createObjectURL(file);
        img.onload = () => {
            const canvas = document.createElement('canvas');
            canvas.width = img.width;
            canvas.height = img.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(img, 0, 0);
            canvas.toBlob(blob => {
                URL.revokeObjectURL(url);
                resolve(blob || file);
            }, file.type, 0.92);
        };
        img.onerror = () => { URL.revokeObjectURL(url); resolve(file); };
        img.src = url;
    });
}

// --- ë©”ì¸ ìƒì„± ë¡œì§ (ëª¨ë°”ì¼ìš© ë°°ì¹˜ 10) ---

async function generateZip() {
    const folderCount = parseInt(document.getElementById('folderCount').value);
    const allowDuplicate = document.getElementById('allowDuplicate').checked;
    const shouldRemoveMetadata = document.getElementById('removeMetadata').checked;
    const companyNameInput = document.getElementById('companyName').value.trim();
    const safeCompanyName = companyNameInput.replace(/[^a-zA-Z0-9ê°€-í£_\-\s]/g, '');

    const totalImgs = categories.reduce((sum, c) => sum + c.files.length, 0);

    if (totalImgs === 0) { alert('ì‚¬ì§„ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”!'); return; }
    // 500ê°œë¡œ ì œí•œ ìƒí–¥
    if (folderCount > 500) { alert('ëª¨ë°”ì¼ì—ì„œëŠ” ìµœëŒ€ 500ì„¸íŠ¸ê¹Œì§€ë§Œ ê¶Œì¥í•©ë‹ˆë‹¤.'); return; }

    const loadingOverlay = document.getElementById('loadingOverlay');
    const loadingText = document.getElementById('loadingText');
    const loadingSubText = document.getElementById('loadingSubText');
    
    loadingOverlay.classList.remove('hidden');
    loadingOverlay.classList.add('flex');
    
    if (shouldRemoveMetadata) loadingSubText.innerHTML = "ğŸ”’ ê°œì¸ì •ë³´ ì œê±° ì¤‘...<br>(ì‹œê°„ì´ ì¢€ ê±¸ë¦½ë‹ˆë‹¤)";

    setTimeout(async () => {
        try {
            // êµ¬ì¡° ì„¤ê³„
            const folderNameTemplate = safeCompanyName 
                ? (idx) => `${String(idx).padStart(2, '0')}_${safeCompanyName}`
                : (idx) => `í¬ìŠ¤íŒ…_${String(idx).padStart(2, '0')}`;

            const allFolders = Array.from({ length: folderCount }, (_, i) => ({
                name: folderNameTemplate(i + 1), files: []
            }));

            // ë¶„ë°° ë¡œì§
            for (const cat of categories) {
                if (cat.files.length === 0) continue;
                const shuffled = shuffle(cat.files);
                
                if (cat.mode === 'required') {
                    for (let fIdx = 0; fIdx < folderCount; fIdx++) {
                        for (let k = 0; k < cat.requiredCount; k++) {
                            const gIdx = fIdx * cat.requiredCount + k;
                            let file = (gIdx < shuffled.length) ? shuffled[gIdx] : (allowDuplicate ? shuffled[gIdx % shuffled.length] : null);
                            if(file) allFolders[fIdx].files.push({ file, fileName: file.name });
                        }
                    }
                } else {
                    let used = 0;
                    for (let fIdx = 0; fIdx < folderCount; fIdx++) {
                        if ((fIdx + 1) % cat.probabilityN === 0) {
                            let file = (used < shuffled.length) ? shuffled[used] : (allowDuplicate ? shuffled[used % shuffled.length] : null);
                            if(file) { allFolders[fIdx].files.push({ file, fileName: file.name }); used++; }
                        }
                    }
                }
            }

            // ëª¨ë°”ì¼ìš© ë°°ì¹˜ ì²˜ë¦¬ (10ê°œì”©)
            const totalBatches = Math.ceil(folderCount / MOBILE_BATCH_SIZE);
            const dateStr = new Date().toISOString().slice(0,10);
            
            for (let i = 0; i < folderCount; i += MOBILE_BATCH_SIZE) {
                const batchIdx = (i / MOBILE_BATCH_SIZE) + 1;
                const batchFolders = allFolders.slice(i, i + MOBILE_BATCH_SIZE);
                const partNum = totalBatches > 1 ? `_Part${batchIdx}` : '';

                loadingText.innerText = `ì••ì¶• ì¤‘... (${batchIdx}/${totalBatches})`;
                
                const zip = new JSZip();
                
                for (const folder of batchFolders) {
                    if(folder.files.length === 0) continue;
                    const fZip = zip.folder(folder.name);
                    const usedNames = new Set();
                    let sortTime = new Date(2023, 0, 1, 9, 0, 0);

                    for (const item of folder.files) {
                        let fData = item.file;
                        if(shouldRemoveMetadata) fData = await cleanImage(fData);

                        let fName = item.fileName;
                        if(usedNames.has(fName)) {
                            let c = 1;
                            const parts = fName.split('.'); const ext = parts.pop(); const base = parts.join('.');
                            while(usedNames.has(fName)) { fName = `${base}(${c}).${ext}`; c++; }
                        }
                        usedNames.add(fName);
                        sortTime.setMinutes(sortTime.getMinutes() + 1);
                        fZip.file(fName, fData, { date: new Date(sortTime) });
                    }
                    // ë©”ëª¨ë¦¬ í•´ì œ íŒíŠ¸
                    await new Promise(r => setTimeout(r, 10)); 
                }

                const content = await zip.generateAsync({ type: 'blob' });
                const zipName = safeCompanyName 
                    ? `blog_mobile_${safeCompanyName}_${dateStr}${partNum}.zip` 
                    : `blog_mobile_${dateStr}${partNum}.zip`;
                
                downloadBlob(content, zipName);
                
                // ëª¨ë°”ì¼ ë¸Œë¼ìš°ì € ìˆ¨ê³ ë¥´ê¸°
                await new Promise(r => setTimeout(r, 1500));
            }

            if(totalBatches > 1) alert('ì—¬ëŸ¬ ê°œì˜ íŒŒì¼ë¡œ ë‚˜ë‰˜ì–´ ì €ì¥ë©ë‹ˆë‹¤.\në‹¤ìš´ë¡œë“œ íŒì—…ì„ í—ˆìš©í•´ì£¼ì„¸ìš”.');

        } catch (e) {
            alert('ì˜¤ë¥˜: ' + e.message + '\nì´ë¯¸ì§€ê°€ ë„ˆë¬´ ë§ìœ¼ë©´ ê°œìˆ˜ë¥¼ ì¤„ì—¬ì£¼ì„¸ìš”.');
        } finally {
            loadingOverlay.classList.add('hidden');
            loadingOverlay.classList.remove('flex');
        }
    }, 100);
}

init();
</script>
</body>
</html>